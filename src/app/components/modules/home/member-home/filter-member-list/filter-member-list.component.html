<div *ngIf="currentsUser" class="d-flex flex-column justify-content-between" style="min-height: 80vh;">

  <!-- ðŸ”¹ Header -->
  <div>
    <div class="d-flex justify-content-between align-items-center mb-2">
      <div class="text-lg fw-bold text-muted p-2">
        âœ¨ {{ totalItemCount === 1 ? 'Matching profile' : 'Matching profiles' }}
      </div>
      <div class="text-lg fw-bold text-muted p-2">
        Total Count: {{ totalItemCount }}
      </div>
    </div>

    <!-- ðŸ”¹ Member List -->
    <div class="row g-2 member-list">
      <app-loading *ngIf="isLoading"></app-loading>

       <div class="col-12 col-md-6 my-1 p-card" *ngFor="let member of memberProfiles |  paginate: { itemsPerPage: itemsPerPage , currentPage: currentPage, totalItems: totalItemCount }">
      <div class="border bg-white p-2 border-15 m-card"  *ngIf="!isLoading">
        <div class="row">
          <div class="col-12 col-md-4">
            <div class="me-2">
            <img src="{{member.imageUrl}}" alt="pf" class="object-fit-cover border border-15 profile-img" width="120px" height="120px">
          </div>
          </div>
          <div class="col-12 col-md-6">
            <div class="text-md fw-bold text-capitalize">{{member.firstName + ' ' + member.lastName}} </div>
            <div class="mt-1 text-sm text-truncate text-capitalize" *ngIf="member.jobTitle"><i class="fas fa-briefcase me-2 text-muted"></i>{{member.jobTitle}}</div>
            <div class="mt-1 text-sm"><i class="fas fa-map-marker-alt me-2 text-muted"></i>{{member.livingAddresses?.country}}</div>
            <div class="mt-1 text-sm"><i class="fas fa-user-clock me-2 text-muted"></i>{{member.age}} years old</div>
            <div class="mt-1 text-sm"><i class="fas fa-star me-2 text-muted"></i>{{member.religion}}</div>
          </div>

          <div class="col-12 col-sm-12 col-md-2 mt-auto">
            <div class="me-2">
            <div class="ms-2 d-flex justify-content-end me-1">
              <div>
                <button class="btn btn-danger" (click)="viewMemberDetails(member.id)" [disabled]="isMemberViewLoading">
                  <i class="fas fa-eye text-white" style="color: white !important;" [ngClass]="{'d-none': isMemberViewLoading && member.id === viewMemberId}"></i>
                  <div class="spinner-border spinner-border-sm text-light me-1" role="status" *ngIf="isMemberViewLoading && member.id === viewMemberId"></div>
                </button>
              </div>
            </div>
          </div>
          </div>
        </div>
      </div>
    </div>


      <!-- No Results -->
      <div class="text-center bg-white rounded p-4" *ngIf="memberProfiles.length === 0 && !isLoading" style="min-height: 70vh;">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSadlux1273cB0AkVXr679QPJmLVpbL_BENSg&s" alt="pf" class="rounded object-fit-cover" width="30%" height="250" />
        <div class="fw-bold text-muted fs-5 mt-3">No matching profiles found</div>
        <div class="text-sm text-muted">Please adjust your filters and try again to find better matches.</div>
      </div>
    </div>
  </div>

  <!-- ðŸ”¹ Pagination (stays at bottom) -->
  <div *ngIf="totalItemCount > 0 && !isLoading" class="mt-auto pt-3 border-top">
    <div class="row align-items-center">
      <div class="col-md-6 col-12">
        <div class="d-flex align-items-center">
          <label class="fw-bold me-2 mb-0"><small>Entries per page</small></label>
          <input type="number" class="form-control form-control-sm w-auto" [(ngModel)]="itemsPerPage" min="1" (change)="changePerPageValue(itemsPerPage)" />
        </div>
      </div>
      <div class="col-md-6 col-12 text-md-end text-center mt-2 mt-md-0">
        <pagination-controls (pageChange)="pageChanged($event)" [maxSize]="5" [previousLabel]="'Prev'" [nextLabel]="'Next'"></pagination-controls>
      </div>
    </div>
  </div>

</div>

<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <!-- <div class="modal-header">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div> -->
      <div class="modal-body p-0">
       <app-member-profile-modal [memberProfile]="filterMemberViewData"></app-member-profile-modal>
      </div>
    </div>
  </div>
</div>
 <button class="d-none" data-bs-toggle="modal" data-bs-target="#staticBackdrop" id="viewProfileModal"></button>
