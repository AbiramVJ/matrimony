<section class="content">
  <div class="component-content">
    <div class="row m-0" [ngClass]="isSingUp ? 'bg-image-s' : 'bg-image'">
      <div class="col-12 col-md-8 col-lg-4 mx-auto">
        <div class="row">
          <div class="col-12">
            <div class="d-flex justify-content-center align-items-center">
              <div class="col-12">
                <div class="m-shadow col-12 p-3 bg-white mt-5">
                  <div class="row">
                    <div class="col-12 d-flex align-item-center justify-content-center">
                      <div class="">
                        <svg xmlns="http://www.w3.org/2000/svg" width="200px" viewBox="0 0 400 150">
                          <defs>
                            <linearGradient id="goldGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                              <stop offset="0%" stop-color="#FFD700" />
                              <stop offset="100%" stop-color="#FFA500" />
                            </linearGradient>
                          </defs>
                          <path d="M10,80 Q60,50 110,80 Q160,110 210,80 Q260,50 310,80 Q360,110 390,80" stroke="#FFD700"
                            stroke-width="2" fill="none" />
                          <circle cx="200" cy="45" r="15" fill="none" stroke="url(#goldGradient)" stroke-width="3" />
                          <circle cx="215" cy="45" r="15" fill="none" stroke="#FF0000" stroke-width="3" />
                          <text x="200" y="90" font-family="'Segoe UI', Arial, sans-serif" font-size="42" font-weight="bold"
                            text-anchor="middle" fill="#FF0000">Matri<tspan fill="#FFD700">mony</tspan></text>
                          <text x="200" y="115" font-family="'Segoe UI', Arial, sans-serif" font-size="16"
                            text-anchor="middle" fill="#333">Forever Begins Here</text>
                        </svg>

                     </div>
                    </div>
                  </div>

                  <div class="d-flex justify-content-between">
                    <div>
                      <h5 class="text-center">{{isSingUp ? 'Sign up' : 'Sign in'}}</h5>
                      <!-- <h6 class="text-center">{{isAgent ? 'agent' : 'user'}}</h6> -->
                    </div>
                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" (click)="changeLoginType()">
                      <label class="form-check-label" for="flexSwitchCheckDefault">Agent</label>
                    </div>
                  </div>
                  <!-- SIGN-UP -->
                  <div *ngIf="!isSingUp">
                    <form [formGroup]="loginForm">
                      <div class="mb-3 mt-3">
                        <label for="email" class="form-label" >Email or Phone number</label>
                        <input type="email" class="form-control" formControlName="email" id="email" placeholder="name@example.com"  [ngClass]="{'errorBorder' : isSubmitted && loginForm.get('email')?.errors}">
                      </div>
                      <div class="mb-3">
                        <label for="password" class="form-label" >password</label>
                        <input type="password" class="form-control" formControlName="password" id="password" placeholder="password" [ngClass]="{'errorBorder' : isSubmitted && loginForm.get('password')?.errors}">
                      </div>
                    </form>
                  </div>
                  <!-- LOGIN -->
                   <div *ngIf="isSingUp">
                    <form [formGroup]="signUpForm">
                      <div class="mb-3 mt-3">
                        <label for="firstname" class="form-label">First name</label>
                        <input type="text" class="form-control" id="first-name" formControlName="firstName" placeholder="john" [ngClass]="{'errorBorder' : isSubmitted && signUpForm.get('firstName')?.errors}">
                      </div>

                      <div class="mb-3">
                        <label for="lasttname" class="form-label">Last name</label>
                        <input type="text" class="form-control" id="last-name" formControlName="lastName" placeholder="wick" [ngClass]="{'errorBorder' : isSubmitted && signUpForm.get('lastName')?.errors}">
                      </div>

                      <div class="mb-3">
                        <label for="s-email" class="form-label">Email address</label>
                        <input type="email" class="form-control" id="email-singup" formControlName="email" placeholder="name@example.com"  [ngClass]="{'errorBorder' : isSubmitted && signUpForm.get('email')?.errors}">
                      </div>

                      <div class="mb-3">
                        <label for="phonenumber" class="form-label">Phone number</label>

                        <div class="mb-3 mt-3">
                            <div class="d-flex">
                              <div class="pn">
                                <ng-select
                                  [items]="phoneCodes"
                                  bindLabel="country"
                                  bindValue="code"
                                  [ngModelOptions]="{standalone: true}"
                                  [clearable]="false"
                                  [searchable]="true"
                                  [(ngModel)]="selectedCode">

                                  <!-- Custom header template with search input -->
                                  <ng-template ng-header-tmp>
                                    <div class="search-container p-2">
                                      <input
                                        type="text"
                                        class="form-control search-input"
                                        placeholder="Search country or code"
                                        (input)="onSearchChange($event)">
                                    </div>
                                  </ng-template>

                                  <!-- Label template -->
                                  <ng-template ng-label-tmp let-item="item">
                                    +{{item.code}}
                                  </ng-template>

                                  <!-- Option template -->
                                  <ng-template ng-option-tmp let-item="item" let-search="searchTerm">
                                    <div class="d-flex">
                                      <div class="me-3">
                                        +{{item.code}}
                                      </div>
                                      <div class="">
                                        {{item.country}}
                                      </div>
                                    </div>
                                  </ng-template>
                                </ng-select>
                              </div>
                              <div class="w-100 pi">
                                <input type="text" class="form-control" id="pn-number" formControlName="phoneNumber" placeholder="0779507217"  [ngClass]="{'errorBorder' : isSubmitted && signUpForm.get('phoneNumber')?.errors}">
                              </div>
                            </div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <label for="password-singnup" class="form-label">password</label>
                        <input type="password" class="form-control" id="password-singnup" formControlName="password" placeholder="password"  [ngClass]="{'errorBorder' : isSubmitted && signUpForm.get('password')?.errors}">
                      </div>
                    </form>
                   </div>
                   <div class="col-12">
                    <button class="btn btn-danger me-3 w-100" (click)="login()" [disabled]="isLoading" *ngIf="!isSingUp">
                      <div class="spinner-border spinner-border-sm text-light me-1" role="status" *ngIf="isLoading"></div>LOGIN</button>
                    <button class="btn btn-danger me-3 w-100"  (click)="signUp()" [disabled]="isLoading" *ngIf="isSingUp">SIGN UP</button>
                    <div class="mt-2 text-right pointer"  data-bs-toggle="modal" href="#exampleModalToggle" *ngIf="!isSingUp">forgot password?</div>
                    <!-- <button class="btn btn-danger me-3" (click)="isSingUp = true">SING-UP</button> -->
                  </div>
                  <div class="divider">
                    <span>OR</span>
                  </div>
                  <div class="d-flex justify-content-center">
                    <div class="btn btn-light me-2"><svg xmlns="http://www.w3.org/2000/svg" class="me-2" width="30px" height="30px" viewBox="-3 0 262 262" preserveAspectRatio="xMidYMid"><path d="M255.878 133.451c0-10.734-.871-18.567-2.756-26.69H130.55v48.448h71.947c-1.45 12.04-9.283 30.172-26.69 42.356l-.244 1.622 38.755 30.023 2.685.268c24.659-22.774 38.875-56.282 38.875-96.027" fill="#4285F4"/><path d="M130.55 261.1c35.248 0 64.839-11.605 86.453-31.622l-41.196-31.913c-11.024 7.688-25.82 13.055-45.257 13.055-34.523 0-63.824-22.773-74.269-54.25l-1.531.13-40.298 31.187-.527 1.465C35.393 231.798 79.49 261.1 130.55 261.1" fill="#34A853"/><path d="M56.281 156.37c-2.756-8.123-4.351-16.827-4.351-25.82 0-8.994 1.595-17.697 4.206-25.82l-.073-1.73L15.26 71.312l-1.335.635C5.077 89.644 0 109.517 0 130.55s5.077 40.905 13.925 58.602l42.356-32.782" fill="#FBBC05"/><path d="M130.55 50.479c24.514 0 41.05 10.589 50.479 19.438l36.844-35.974C195.245 12.91 165.798 0 130.55 0 79.49 0 35.393 29.301 13.925 71.947l42.211 32.783c10.59-31.477 39.891-54.251 74.414-54.251" fill="#EB4335"/></svg></div>
                    <div class="btn btn-light"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="30px" height="30px"><path fill="#039be5" d="M24 5A19 19 0 1 0 24 43A19 19 0 1 0 24 5Z"/><path fill="#fff" d="M26.572,29.036h4.917l0.772-4.995h-5.69v-2.73c0-2.075,0.678-3.915,2.619-3.915h3.119v-4.359c-0.548-0.074-1.707-0.236-3.897-0.236c-4.573,0-7.254,2.415-7.254,7.917v3.323h-4.701v4.995h4.701v13.729C22.089,42.905,23.032,43,24,43c0.875,0,1.729-0.08,2.572-0.194V29.036z"/></svg></div>
                  </div>
                  <div class="mt-3" *ngIf="!isSingUp">Need and account? <u class="pointer" (click)="isSingUp = true; loginForm.reset(); isSubmitted = false">SIGN UP</u></div>
                  <div class="mt-3" *ngIf="isSingUp">Already have and account? <u class="pointer" (click)="isSingUp = false ; signUpForm.reset(); isSubmitted = false">SIGN IN</u></div>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<div class="modal fade" id="exampleModalToggle" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true" >
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header border-bottom-0 pb-0">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="formsReset()"></button>
      </div>

      <div class="modal-body pt-0">
        <div class="row">
          <div class="col-sm-10 col-12 mx-auto">
            <div>
              <div class="d-flex " [ngClass]="step === resetStep.enterEmail ? 'justify-content-center' : 'justify-content-between' ">
                <div class="pointer" (click)="backToStep()" *ngIf="step > resetStep.enterEmail">
                  <i class="fas fa-arrow-left fs-5 mt-2"></i>
                </div>
                <div><h4 class="modal-title fw-bold" id="exampleModalToggleLabel"> {{step === resetStep.enterEmail ? 'Reset password' : step === resetStep.verification ? 'Enter your verification code' : 'Create new password'}}</h4></div>
                <div></div>
              </div>
                <!-- STEP ONE -->
                <div *ngIf="step === resetStep.enterEmail">
                  <div class="text-center">
                    <img src="https://cdni.iconscout.com/illustration/premium/thumb/otp-authentication-illustration-download-in-svg-png-gif-file-formats--one-time-password-security-protection-business-pack-illustrations-5840953.png" alt="" width="250px">
                    <div class="text-center text-muted">Please enter your email address to receive a verification code </div>
                  </div>

                  <form [formGroup]="forgotForm">
                    <div class="mb-3 mt-3">
                      <label for="f-email" class="form-label" >Email or Phone number</label>
                      <input type="email" class="form-control" formControlName="email" id="f-email" placeholder="name@example.com"  [ngClass]="{'errorBorder' : isSubmitted && forgotForm.get('email')?.errors}">
                    </div>
                  </form>
                </div>

                <!-- STEP 2 -->
                 <div *ngIf="step === resetStep.verification">
                    <div class="otp-container">
                      <form [formGroup]="otpForm">
                        <div class="otp-input-container">
                          <ng-container *ngFor="let control of inputControls; let i = index; trackBy: trackByFn">
                            <input
                              type="text"
                              class="otp-input"
                              maxlength="1"
                              [formControlName]="control"
                              (input)="onInput($event, i)"
                              (keydown)="onKeyDown($event, i)"
                              (paste)="onPaste($event)"
                              autocomplete="off"
                              inputmode="numeric"
                              pattern="[0-9]*"
                            />
                          </ng-container>
                        </div>
                      </form>
                    </div>
                    <div class="text-sm text-muted mt-3">
                      We send a four digits verification code to your email <b>{{forgotForm.get('email')?.value}}</b>. You can check your inbox.
                    </div>
                    <div class="mt-3 text-primary pointer">
                      <u>I didn't receive the code? Send again</u>
                    </div>
                 </div>

                 <div *ngIf="step === resetStep.resetPassword">
                  <div class="text-center">
                    <img src="https://cdni.iconscout.com/illustration/premium/thumb/forgot-password-reset-illustration-download-in-svg-png-gif-file-formats--restore-cyber-security-business-technology-pack-illustrations-5889578.png" alt="" width="250px">
                    <div class="text-center text-muted">Your new password must be different form previous used passwords.</div>
                  </div>

                  <div class="mt-3">
                    <form [formGroup]="passwordReset">
                      <div class="mb-3">
                        <label for="password-comfirm" class="form-label">Password</label>
                        <input type="password" class="form-control" id="password-comfirm" formControlName="password" placeholder="password"  [ngClass]="{'errorBorder' : isSubmitted && passwordReset.get('password')?.errors}"  (input)="onInputChange()">
                      </div>

                      <div class="">
                        <label for="password-singnup" class="form-label">Confirm Password</label>
                        <input type="password" class="form-control" id="password-singnup" formControlName="confirmPassword" placeholder="confirm password"  [ngClass]="{'errorBorder' : isSubmitted && passwordReset.get('confirmPassword')?.errors}" (input)="onInputChange()" >
                      </div>
                      <div class="text-danger" *ngIf="!isMatchPwd">Password does not match</div>
                    </form>
                  </div>

                 </div>
              </div>
            <button class="btn btn-danger me-3 w-100" [disabled]="isLoading" (click)="sendOtp()" *ngIf="step === resetStep.enterEmail">
              <div class="spinner-border spinner-border-sm text-light me-1" role="status" *ngIf="isLoading"></div>send
            </button>
            <button class="btn btn-danger me-3 w-100 mt-3 mb-3" [disabled]="isLoading" (click)="verifyOtp()" *ngIf="step === resetStep.verification">
              <div class="spinner-border spinner-border-sm text-light me-1" role="status" *ngIf="isLoading"></div>Verify
            </button>
            <button class="btn btn-danger me-3 w-100 mt-3 mb-3" [disabled]="isLoading" (click)="createPassword()" *ngIf="step === resetStep.resetPassword">
              <div class="spinner-border spinner-border-sm text-light me-1" role="status" *ngIf="isLoading"></div>Create
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
