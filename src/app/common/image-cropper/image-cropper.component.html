<div class="image-cropper-container">
  <div class="cropper-card">
    <!-- Header -->
    <!-- <div class="cropper-header">
      <h2 class="cropper-title">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect width="18" height="18" x="3" y="3" rx="2" ry="2"/>
          <circle cx="9" cy="9" r="2"/>
          <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
        </svg>
        Image Cropper
      </h2>
      <p class="cropper-subtitle">Upload and crop your image to perfection</p>
    </div> -->

    <!-- Upload Area -->
    <div class="upload-section" *ngIf="!imageChangedEvent">
      <input
        #fileInput
        type="file"
        (change)="fileChangeEvent($event)"
        accept="image/*"
        style="display: none;"
      />

      <div class="upload-area" (click)="fileInput.click()">
        <div class="upload-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" x2="12" y1="3" y2="15"/>
          </svg>
        </div>
        <h3 class="upload-title">Click to upload image</h3>
        <!-- <p class="upload-description">or drag and drop</p> -->
        <p class="upload-formats">PNG, JPG, GIF up to 2MB</p>
      </div>
    </div>

    <!-- Cropper Section -->
    <div class="cropper-section" *ngIf="imageChangedEvent">
      <!-- Aspect Ratio Controls -->
      <div class="controls-bar">
        <div class="aspect-ratio-buttons">
          <button
            *ngFor="let ratio of aspectRatios"
            [class.active]="selectedRatio === ratio.value"
            (click)="setAspectRatio(ratio.value)"
            class="ratio-button">
            {{ ratio.label }}
          </button>
        </div>

        <button class="reset-button" (click)="resetImage()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
            <path d="M3 3v5h5"/>
          </svg>
          Reset
        </button>
      </div>


      <!-- Cropper -->
      <div class="cropper-wrapper">
        <image-cropper
          [imageChangedEvent]="imageChangedEvent"
          [maintainAspectRatio]="maintainAspectRatio"
          [aspectRatio]="currentAspectRatio"
          [resizeToWidth]="1024"

          format="png"
          [roundCropper]="roundCropper"
          (imageCropped)="imageCropped($event)"
          (imageLoaded)="imageLoaded($event)"
          (cropperReady)="cropperReady()"
          (loadImageFailed)="loadImageFailed()"
        ></image-cropper>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button class="btn btn-secondary" (click)="cancelCrop()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" x2="6" y1="6" y2="18"/>
            <line x1="6" x2="18" y1="6" y2="18"/>
          </svg>
          Cancel
        </button>
        <button class="btn btn-primary" (click)="saveCroppedImage()" [disabled]="!croppedImage || isUploading">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
            <polyline points="17 21 17 13 7 13 7 21"/>
            <polyline points="7 3 7 8 15 8"/>
          </svg>
          Save Image <div class="spinner-border spinner-border-sm text-light me-1" *ngIf="isUploading"></div>
        </button>
      </div>
    </div>
  </div>
</div>
